!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/overlay"),require("@angular/common"),require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/cdk/portal"),require("@angular/cdk/a11y")):"function"==typeof define&&define.amd?define("@try/context-menu",["exports","@angular/cdk/overlay","@angular/common","@angular/core","rxjs","rxjs/operators","@angular/cdk/portal","@angular/cdk/a11y"],t):t(((e=e||self)["try"]=e["try"]||{},e["try"]["context-menu"]={}),e.ng.cdk.overlay,e.ng.common,e.ng.core,e.rxjs,e.rxjs.operators,e.ng.cdk.portal,e.ng.cdk.a11y)}(this,function(e,t,n,o,i,s,r,a){"use strict";var u=function(){return(u=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function c(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r}function p(e,t){return function(n,o){t(n,o,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}var d=function(){function e(e,t){this.template=e,this.elementRef=t,this.divider=!1,this.enabled=!0,this.passive=!1,this.visible=!0,this.execute=new o.EventEmitter,this.isActive=!1}return Object.defineProperty(e.prototype,"disabled",{get:function(){return this.passive||this.divider||!this.evaluateIfFunction(this.enabled,this.currentItem)},enumerable:!0,configurable:!0}),e.prototype.evaluateIfFunction=function(e,t){return e instanceof Function?e(t):e},e.prototype.setActiveStyles=function(){this.isActive=!0},e.prototype.setInactiveStyles=function(){this.isActive=!1},e.prototype.triggerExecute=function(e,t){this.evaluateIfFunction(this.enabled,e)&&this.execute.emit({event:t,item:e})},c([o.Input(),l("design:type",Object)],e.prototype,"subMenu",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"divider",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"enabled",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"passive",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"visible",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"execute",void 0),e=c([o.Directive({selector:"[contextMenuItem]"}),l("design:paramtypes",[o.TemplateRef,o.ElementRef])],e)}(),y=new o.InjectionToken("CONTEXT_MENU_OPTIONS"),v=function(){function e(e,t,n,s){this.changeDetector=e,this.elementRef=t,this.options=n,this.renderer=s,this.menuItems=[],this.isLeaf=!1,this.execute=new o.EventEmitter,this.openSubMenu=new o.EventEmitter,this.closeLeafMenu=new o.EventEmitter,this.closeAllMenus=new o.EventEmitter,this.autoFocus=!1,this.useBootstrap4=!1,this.subscription=new i.Subscription,n&&(this.autoFocus=n.autoFocus,this.useBootstrap4=n.useBootstrap4)}return e.prototype.ngOnInit=function(){var e=this;this.menuItems.forEach(function(t){t.currentItem=e.item,e.subscription.add(t.execute.subscribe(function(n){return e.execute.emit(u({},n,{menuItem:t}))}))});var t=new o.QueryList;t.reset(this.menuItems),this._keyManager=new a.ActiveDescendantKeyManager(t).withWrap()},e.prototype.ngAfterViewInit=function(){var e=this;this.autoFocus&&setTimeout(function(){return e.focus()}),this.overlay.updatePosition()},e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.focus=function(){this.autoFocus&&this.menuElement.nativeElement.focus()},e.prototype.stopEvent=function(e){e.stopPropagation()},e.prototype.isMenuItemEnabled=function(e){return this.evaluateIfFunction(e&&e.enabled)},e.prototype.isMenuItemVisible=function(e){return this.evaluateIfFunction(e&&e.visible)},e.prototype.evaluateIfFunction=function(e){return e instanceof Function?e(this.item):e},e.prototype.isDisabled=function(e){return e.enabled&&!e.enabled(this.item)},e.prototype.onKeyEvent=function(e){this.isLeaf&&this._keyManager.onKeydown(e)},e.prototype.keyboardOpenSubMenu=function(e){if(this.isLeaf){this.cancelEvent(e);var t=this.menuItems[this._keyManager.activeItemIndex];t&&this.onOpenSubMenu(t)}},e.prototype.keyboardMenuItemSelect=function(e){if(this.isLeaf){this.cancelEvent(e);var t=this.menuItems[this._keyManager.activeItemIndex];t&&this.onMenuItemSelect(t,e)}},e.prototype.onCloseLeafMenu=function(e){this.isLeaf&&(this.cancelEvent(e),this.closeLeafMenu.emit({exceptRootMenu:37===e.keyCode,event:e}))},e.prototype.closeMenu=function(e){"click"===e.type&&2===e.button||this.closeAllMenus.emit({event:e})},e.prototype.onOpenSubMenu=function(e,t){var n=this.menuItemElements.toArray()[this._keyManager.activeItemIndex],o=n&&n.nativeElement;this.openSubMenu.emit({anchorElement:o,contextMenu:e.subMenu,event:t,item:this.item,parentContextMenu:this})},e.prototype.onMenuItemSelect=function(e,t){t.preventDefault(),t.stopPropagation(),this.onOpenSubMenu(e,t),e.subMenu||e.triggerExecute(this.item,t)},e.prototype.cancelEvent=function(e){if(e){var t=e.target;["INPUT","TEXTAREA","SELECT"].indexOf(t.tagName)>-1||t.isContentEditable||(e.preventDefault(),e.stopPropagation())}},c([o.Input(),l("design:type",Array)],e.prototype,"menuItems",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"item",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"event",void 0),c([o.Input(),l("design:type",e)],e.prototype,"parentContextMenu",void 0),c([o.Input(),l("design:type",String)],e.prototype,"menuClass",void 0),c([o.Input(),l("design:type",t.OverlayRef)],e.prototype,"overlay",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"isLeaf",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"execute",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"openSubMenu",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"closeLeafMenu",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"closeAllMenus",void 0),c([o.ViewChild("menu"),l("design:type",o.ElementRef)],e.prototype,"menuElement",void 0),c([o.ViewChildren("li"),l("design:type",o.QueryList)],e.prototype,"menuItemElements",void 0),c([o.HostListener("window:keydown.ArrowDown",["$event"]),o.HostListener("window:keydown.ArrowUp",["$event"]),l("design:type",Function),l("design:paramtypes",[KeyboardEvent]),l("design:returntype",void 0)],e.prototype,"onKeyEvent",null),c([o.HostListener("window:keydown.ArrowRight",["$event"]),l("design:type",Function),l("design:paramtypes",[KeyboardEvent]),l("design:returntype",void 0)],e.prototype,"keyboardOpenSubMenu",null),c([o.HostListener("window:keydown.Enter",["$event"]),o.HostListener("window:keydown.Space",["$event"]),l("design:type",Function),l("design:paramtypes",[KeyboardEvent]),l("design:returntype",void 0)],e.prototype,"keyboardMenuItemSelect",null),c([o.HostListener("window:keydown.Escape",["$event"]),o.HostListener("window:keydown.ArrowLeft",["$event"]),l("design:type",Function),l("design:paramtypes",[KeyboardEvent]),l("design:returntype",void 0)],e.prototype,"onCloseLeafMenu",null),c([o.HostListener("document:click",["$event"]),o.HostListener("document:contextmenu",["$event"]),l("design:type",Function),l("design:paramtypes",[MouseEvent]),l("design:returntype",void 0)],e.prototype,"closeMenu",null),e=c([o.Component({selector:"context-menu-content",template:'<div class="dropdown open show ngx-contextmenu" [ngClass]="menuClass" tabindex="0">\n  <ul #menu class="dropdown-menu show" style="position: static; float: none;" tabindex="0">\n    <li #li *ngFor="let menuItem of menuItems; let i = index" [class.disabled]="!isMenuItemEnabled(menuItem)"\n        [class.divider]="menuItem.divider" [class.dropdown-divider]="useBootstrap4 && menuItem.divider"\n        [class.active]="menuItem.isActive && isMenuItemEnabled(menuItem)"\n        [attr.role]="menuItem.divider ? \'separator\' : undefined">\n      <a *ngIf="!menuItem.divider && !menuItem.passive" href [class.dropdown-item]="useBootstrap4"\n        [class.active]="menuItem.isActive && isMenuItemEnabled(menuItem)"\n        [class.disabled]="useBootstrap4 && !isMenuItemEnabled(menuItem)" [class.hasSubMenu]="!!menuItem.subMenu"\n        (click)="onMenuItemSelect(menuItem, $event)" (mouseenter)="onOpenSubMenu(menuItem, $event)">\n        <ng-template [ngTemplateOutlet]="menuItem.template" [ngTemplateOutletContext]="{ $implicit: item }"></ng-template>\n      </a>\n\n      <span (click)="stopEvent($event)" (contextmenu)="stopEvent($event)" class="passive"\n            *ngIf="!menuItem.divider && menuItem.passive" [class.dropdown-item]="useBootstrap4"\n            [class.disabled]="useBootstrap4 && !isMenuItemEnabled(menuItem)">\n        <ng-template [ngTemplateOutlet]="menuItem.template" [ngTemplateOutletContext]="{ $implicit: item }"></ng-template>\n      </span>\n    </li>\n  </ul>\n</div>',styles:['\n    .passive {\n        display: block;\n        padding: 3px 20px;\n        clear: both;\n        font-weight: normal;\n        line-height: @line-height-base;\n        white-space: nowrap;\n    }\n    .hasSubMenu:before {\n      content: "▶";\n      float: right;\n    }\n    ']}),p(2,o.Optional()),p(2,o.Inject(y)),l("design:paramtypes",[o.ChangeDetectorRef,o.ElementRef,Object,o.Renderer2])],e)}(),m=function(){function e(e,t){this.overlay=e,this.scrollStrategy=t,this.isDestroyingLeafMenu=!1,this.show=new i.Subject,this.triggerClose=new i.Subject,this.close=new i.Subject,this.overlays=[],this.fakeElement={getBoundingClientRect:function(){return{bottom:0,height:0,left:0,right:0,top:0,width:0}}}}return e.prototype.openContextMenu=function(e){var t,n=e.anchorElement,i=e.event,s=e.parentContextMenu;if(s){t=this.overlay.position().connectedTo(new o.ElementRef(i?i.target:n),{originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"}).withFallbackPosition({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"}).withFallbackPosition({originX:"end",originY:"bottom"},{overlayX:"start",overlayY:"bottom"}).withFallbackPosition({originX:"start",originY:"bottom"},{overlayX:"end",overlayY:"bottom"});var r=this.overlay.create({positionStrategy:t,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()});this.destroySubMenus(s),this.overlays=this.overlays.concat(r),this.attachContextMenu(r,e)}else{var a=i;this.fakeElement.getBoundingClientRect=function(){return{bottom:a.clientY,height:0,left:a.clientX,right:a.clientX,top:a.clientY,width:0}},this.closeAllContextMenus({eventType:"cancel",event:i}),t=this.overlay.position().connectedTo(new o.ElementRef(n||this.fakeElement),{originX:"start",originY:"bottom"},{overlayX:"start",overlayY:"top"}).withFallbackPosition({originX:"start",originY:"top"},{overlayX:"start",overlayY:"bottom"}).withFallbackPosition({originX:"end",originY:"top"},{overlayX:"start",overlayY:"top"}).withFallbackPosition({originX:"start",originY:"top"},{overlayX:"end",overlayY:"top"}).withFallbackPosition({originX:"end",originY:"center"},{overlayX:"start",overlayY:"center"}).withFallbackPosition({originX:"start",originY:"center"},{overlayX:"end",overlayY:"center"}),this.overlays=[this.overlay.create({positionStrategy:t,panelClass:"ngx-contextmenu",scrollStrategy:this.scrollStrategy.close()})],this.attachContextMenu(this.overlays[0],e)}},e.prototype.attachContextMenu=function(e,t){var n=this,o=t.event,s=t.item,a=t.menuItems,c=t.menuClass,p=e.attach(new r.ComponentPortal(v));p.instance.event=o,p.instance.item=s,p.instance.menuItems=a,p.instance.overlay=e,p.instance.isLeaf=!0,p.instance.menuClass=c,e.contextMenu=p.instance;var l=new i.Subscription;l.add(p.instance.execute.asObservable().subscribe(function(e){return n.closeAllContextMenus(u({eventType:"execute"},e))})),l.add(p.instance.closeAllMenus.asObservable().subscribe(function(e){return n.closeAllContextMenus(u({eventType:"cancel"},e))})),l.add(p.instance.closeLeafMenu.asObservable().subscribe(function(e){return n.destroyLeafMenu(e)})),l.add(p.instance.openSubMenu.asObservable().subscribe(function(e){n.destroySubMenus(p.instance),e.contextMenu?(p.instance.isLeaf=!1,n.show.next(e)):p.instance.isLeaf=!0})),p.onDestroy(function(){a.forEach(function(e){return e.isActive=!1}),l.unsubscribe()}),p.changeDetectorRef.detectChanges()},e.prototype.closeAllContextMenus=function(e){this.overlays&&(this.close.next(e),this.overlays.forEach(function(e,t){e.detach(),e.dispose()})),this.overlays=[]},e.prototype.getLastAttachedOverlay=function(){for(var e=this.overlays[this.overlays.length-1];this.overlays.length>1&&e&&!e.hasAttached();)e.detach(),e.dispose(),this.overlays=this.overlays.slice(0,-1),e=this.overlays[this.overlays.length-1];return e},e.prototype.destroyLeafMenu=function(e){var t=this,n=void 0===e?{}:e,o=n.exceptRootMenu,i=n.event;this.isDestroyingLeafMenu||(this.isDestroyingLeafMenu=!0,setTimeout(function(){var e=t.getLastAttachedOverlay();t.overlays.length>1&&e&&(e.detach(),e.dispose()),!o&&t.overlays.length>0&&e&&(t.close.next({eventType:"cancel",event:i}),e.detach(),e.dispose());var n=t.getLastAttachedOverlay();n&&(n.contextMenu.isLeaf=!0),t.isDestroyingLeafMenu=!1}))},e.prototype.destroySubMenus=function(e){var t=e.overlay,n=this.overlays.indexOf(t);this.overlays.slice(n+1).forEach(function(e){e.detach(),e.dispose()})},e.prototype.isLeafMenu=function(e){var t=this.getLastAttachedOverlay();return e.overlay===t},e=c([o.Injectable(),l("design:paramtypes",[t.Overlay,t.ScrollStrategyOptions])],e)}(),h=function(){function e(e,t,n,s){var r=this;this._contextMenuService=e,this.changeDetector=t,this.elementRef=n,this.options=s,this.menuClass="",this.autoFocus=!1,this.useBootstrap4=!1,this.disabled=!1,this.close=new o.EventEmitter,this.open=new o.EventEmitter,this.visibleMenuItems=[],this.links=[],this.subscription=new i.Subscription,s&&(this.autoFocus=s.autoFocus,this.useBootstrap4=s.useBootstrap4),this.subscription.add(e.show.subscribe(function(e){r.onMenuEvent(e)}))}return e.prototype.ngOnDestroy=function(){this.subscription.unsubscribe()},e.prototype.onMenuEvent=function(e){var t=this;if(!this.disabled){var n=e.contextMenu,o=e.event,i=e.item;n&&n!==this||(this.event=o,this.item=i,this.setVisibleMenuItems(),this._contextMenuService.openContextMenu(u({},e,{menuItems:this.visibleMenuItems,menuClass:this.menuClass})),this._contextMenuService.close.asObservable().pipe(s.first()).subscribe(function(e){return t.close.emit(e)}),this.open.next(e))}},e.prototype.isMenuItemVisible=function(e){return this.evaluateIfFunction(e.visible)},e.prototype.setVisibleMenuItems=function(){var e=this;this.visibleMenuItems=this.menuItems.filter(function(t){return e.isMenuItemVisible(t)})},e.prototype.evaluateIfFunction=function(e){return e instanceof Function?e(this.item):e},c([o.Input(),l("design:type",Object)],e.prototype,"menuClass",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"autoFocus",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"useBootstrap4",void 0),c([o.Input(),l("design:type",Object)],e.prototype,"disabled",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"close",void 0),c([o.Output(),l("design:type",o.EventEmitter)],e.prototype,"open",void 0),c([o.ContentChildren(d),l("design:type",o.QueryList)],e.prototype,"menuItems",void 0),c([o.ViewChild("menu"),l("design:type",o.ElementRef)],e.prototype,"menuElement",void 0),e=c([o.Component({encapsulation:o.ViewEncapsulation.None,selector:"context-menu",template:" ",styles:["\n    .cdk-overlay-container {\n      position: fixed;\n      z-index: 1000;\n      pointer-events: none;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n    }\n    .ngx-contextmenu.cdk-overlay-pane {\n      position: absolute;\n      pointer-events: auto;\n      box-sizing: border-box;\n    }\n  "]}),p(3,o.Optional()),p(3,o.Inject(y)),l("design:paramtypes",[m,o.ChangeDetectorRef,o.ElementRef,Object])],e)}(),f=function(){function e(e){this.contextMenuService=e}return e.prototype.onContextMenu=function(e){this.contextMenu.disabled||(this.contextMenuService.show.next({contextMenu:this.contextMenu,event:e,item:this.contextMenuSubject}),e.preventDefault(),e.stopPropagation())},c([o.Input(),l("design:type",Object)],e.prototype,"contextMenuSubject",void 0),c([o.Input(),l("design:type",h)],e.prototype,"contextMenu",void 0),c([o.HostListener("contextmenu",["$event"]),l("design:type",Function),l("design:paramtypes",[MouseEvent]),l("design:returntype",void 0)],e.prototype,"onContextMenu",null),e=c([o.Directive({selector:"[contextMenu]"}),l("design:paramtypes",[m])],e)}(),g=function(){function e(){}var i;return i=e,e.forRoot=function(e){return{ngModule:i,providers:[m,{provide:y,useValue:e}]}},e=i=c([o.NgModule({declarations:[f,h,v,d],entryComponents:[v],exports:[f,h,d],imports:[n.CommonModule,t.OverlayModule]})],e)}();e.ContextMenuComponent=h,e.ContextMenuModule=g,e.ContextMenuService=m,e.ɵa=f,e.ɵb=d,e.ɵc=y,e.ɵd=v,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=try-context-menu.umd.min.js.map